<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <title>AriUM Scaffolding</title>
        <!-- Bootstrap styles -->
        <link href="Content/bootstrap.min.css" rel="stylesheet" media="screen" />
        <!-- Kendo styles -->
        <link href="Content/kendo/2012.3.1114/kendo.common.min.css" rel="stylesheet" />
        <link href="Content/kendo/2012.3.1114/kendo.bootstrap.min.css" rel="stylesheet" />
        <!-- Ariadna styles -->
        <link href="Content/ariadna.css" rel="stylesheet" />

        <!-- JQuery -->
        <script src="Scripts/kendo/2012.3.1114/jquery.min.js"></script>
        <!-- Bootstrap -->
        <script src="Scripts/bootstrap.min.js"></script>
        <!-- Bootbox -->
        <script src="Scripts/bootbox.js"></script>
        <!-- Kendo -->
        <script src="Scripts/kendo/2012.3.1114/kendo.web.min.js"></script>
        <script src="Scripts/kendo/2012.3.1114/cultures/kendo.culture.es-ES.min.js"></script>
        <!-- Ariadna  -->
        <script src="Scripts/ariadna/ariadna.um.js"></script>
        <script src="Scripts/ariadna/ariadna.localization.es-ES.js"></script>
        <!-- Configuration via JSON -->
        <script src="config.js"></script>
    </head>
    <body>
        <header id="cabecera">
        </header>
        <div id="cuerpo" style="min-height:400px;">
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span12">
                        <h3>Grupo de usuarios</h3>
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="span2">
                        <label>ID</label>
                        <input class="span12 k-text" type="text" id="txtId" readonly="true" />
                    </div>
                    <div class="span10">
                        <label>Nombre</label>
                        <input class="span12 k-text" type="text" id="txtName" required validationMessage="Se necesita un nombre" />
                    </div>
                </div>
                <div class="row-fluid">
                    <div class="pull-right">
                        <button id="accept" class="btn btn-primary" title="Guardar cambios"><i class="icon-ok icon-white"></i></button> 
                        <a id="cancel" href="userGroupGrid.html" class="btn btn-primary" title="Salir"><i class="icon-arrow-left icon-white"></i></a> 
                    </div>
                </div>
            </div>
        </div>
        <footer id="pie">
        </footer>
        <!-- General form treatment -->
        <script type="text/javascript">
            (function ($) {
                $(document).ready(function () {
                    cargaCabeceraPie();
                    // set title
                    document.title = "Grupo de usuarios";
                    // culture Spanish - Spain
                    kendo.culture("es-ES");
                    // cheking url parameters
                    var userGroupId = gup("UserGroupId");
                    // is new?
                    var isNew = true;
                    if (userGroupId != "") {
                        isNew = false;
                        getData(userGroupId);
                    }
                    // focus in the first field
                    $("#txtName").focus();
                    // accept button
                    $("#accept").click(function () {
                        // set validator
                        var validator = $("#cuerpo").kendoValidator().data("kendoValidator");
                        if (validator.validate()) {
                            var userGroup = unloadData();
                            setData(userGroup, isNew);
                        }
                    });
                });
            })(jQuery);
        </script>
        <!-- Specific form treatment -->
        <script type="text/javascript">
            // get data from server
            function getData(userGroupId) {
                var url = controller_url.userGroups + userGroupId;
                var options = {
                    type: 'GET',
                    url: url,
                    dataType: 'json',
                    success: function (data, textStatus) {
                        loadData(data);
                    }
                };
                $.ajax(options);
            }
            // load data into form
            function loadData(userGroup) {
                $("#txtId").val(userGroup.UserGroupId);
                $("#txtName").val(userGroup.Name);
            }
            // send data to server
            function setData(userGroup, isNew) {
                var url = controller_url.userGroups;
                var type = "";
                var returnUrl = "";
                if (isNew) {
                    type = "POST";
                    returnUrl = "userGroupGrid.html?page=0";
                } else {
                    type = "PUT";
                    url = url + userGroup.UserGroupId;
                    returnUrl = "userGroupGrid.html?page=" + gup("page");
                }
                var options = {
                    type: type,
                    url: url,
                    dataType: 'json',
                    data: userGroup,
                    success: function (data, textStatus) {
                        ari_windowOpen(returnUrl);
                    }
                };
                $.ajax(options);
            }
            // unload form data
            function unloadData() {
                var userGroup = new Object();
                userGroup.UserGroupId = $("#txtId").val();
                userGroup.Name = $("#txtName").val();
                return userGroup;
            }
        </script>
    </body>
</html>
